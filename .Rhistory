plot(ct2)
ct6 <- gam(Volume ~ te(Height,Girth,k=5),
family=Gamma(link=log),
data=trees)
ct6
plot(ct6, too.far=0.15)
ct7 <- gam(Volume ~ Height + s(Girth),
family=Gamma(link=log),
data=trees)
summary(ct7)
plot(ct7)
AIC(ct7)
library(tidyverse)
library(lubridate)
library(nycflights13)
weather_lga <- weather %>%
mutate(dt =  make_date(year, month, day)) %>%
filter(origin == "LGA")
weather_lga %>%
ggplot(aes(x = dt, y = temp, colour = factor(hour))) +
geom_line()
weather_lga %>%
group_by(month, hour) %>%
summarise(t_avg = mean(temp)) %>%
ggplot(aes(x = hour, y = t_avg, colour = factor(month))) +
geom_line()
library(RcppRoll)
weather_lga <- weather_lga %>%
filter(hour == 7) %>%
mutate(t_3d_before = roll_meanr(lag(temp), 3)) %>%
mutate(tdiff_3 = temp - t_3d_before)
weather_lga %>%
ggplot() +
geom_line(aes(dt, tdiff_3))
weather_lga <- weather_lga %>%
mutate(tdiff_3_median = temp - roll_medianr(lag(temp), 3))
weather_lga %>%
ggplot() +
geom_line(aes(dt, tdiff_3_median))
library(mgcv)
daily <- flights %>%
mutate(date = make_date(year, month, day)) %>%
group_by(date) %>%
summarise(n = n()) %>%
mutate(wkday = factor(wday(date, label = TRUE), ordered = FALSE ),
date_n = as.numeric(date))
daily <- daily %>% left_join(select(weather_lga, date = dt, tdiff_3, temp))
options(noaakey = "rDTwlWaBaEhgLTdUmweVHtnpoViEAZig") #Token
perth_wdata1 <- ncdc(
datasetid = "GHCND",
stationid='GHCND:ASN00009021',
startdate = "2013-07-02",
enddate = "2014-06-30",
limit = 1000
)$data
perth_wdata2 <- ncdc(
datasetid = "GHCND",
stationid='GHCND:ASN00009021',
startdate = "2014-05-31",
enddate = "2014-06-30",
limit = 1000
)$data
perth_wd <- rbind(perth_wdata1, perth_wdata2) %>%
distinct()  %>%
dplyr::select(date, datatype, station, value) %>%
pivot_wider(names_from = datatype, values_from = value) %>%
mutate(date = date(as_date(date)))
View(perth_wd)
options(noaakey = "rDTwlWaBaEhgLTdUmweVHtnpoViEAZig") #Token
perth_wdata1 <- ncdc(
datasetid = "GHCND",
stationid='GHCND:ASN00009021',
startdate = "2013-07-02",
enddate = "2014-06-30",
limit = 1000
)$data
perth_wdata2 <- ncdc(
datasetid = "GHCND",
stationid='GHCND:ASN00009021',
startdate = "2014-05-31",
enddate = "2014-06-30",
limit = 1000
)$data
perth_wd <- rbind(perth_wdata1, perth_wdata2) %>%
distinct()  %>%
dplyr::select(date, datatype, station, value) %>%
pivot_wider(names_from = datatype, values_from = value) %>%
mutate(date = date(as_date(date)))
View(perth_wd)
View(perth_wdata1)
options(noaakey = "rDTwlWaBaEhgLTdUmweVHtnpoViEAZig") #Token
perth_wdata1 <- ncdc(
datasetid = "GHCND",
stationid='GHCND:ASN00009021',
startdate = "2013-07-02",
enddate = "2014-06-30",
limit = 1000
)$data
perth_wdata2 <- ncdc(
datasetid = "GHCND",
stationid='GHCND:ASN00009021',
startdate = "2014-03-09",
enddate = "2014-06-30",
limit = 1000
)$data
perth_wd <- rbind(perth_wdata1, perth_wdata2) %>%
distinct()  %>%
dplyr::select(date, datatype, station, value) %>%
pivot_wider(names_from = datatype, values_from = value) %>%
mutate(date = date(as_date(date)))
View(perth_wd)
mean(c(216,22))
perth_wdata1 <- ncdc(
datasetid = "GHCND",
stationid='GHCND:ASN00009021', # PERTH AIRPORT, AS
startdate = "1971-01-01",
enddate = "2000-01-01",
limit = 1000
)$data
library(tidyverse)
library(fitdistrplus)
library(magrittr)
library(skimr)
library(scales)
library(rnoaa)
library(MASS)
library(lubridate)
library(broom)
library(visreg)
library(lmtest)
library(mgcv)
library(gamair)
library(robustHD)
library(RCurl)
t <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
View(t)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
View(Royal_Perth_Hospital)
write_csv(Royal_Perth_Hospital, "/Users/typhaine/Documents/Doc_Gorilla/Deakin Uni/Data/")
write_csv(Royal_Perth_Hospital, "\Users\typhaine\Documents\Doc_Gorilla\Deakin Uni\Data\")
write_csv(Royal_Perth_Hospital, "C:/Users/typhaine/Documents/Doc_Gorilla/Deakin Uni/Data/")
write_csv(Royal_Perth_Hospital, "/Home/Documents/Doc_Gorilla/Deakin Uni/Data/")
setwd("~/Documents/Doc_Gorilla/Deakin Uni/Data")
write_csv(Royal_Perth_Hospital, "/Home/Documents/Doc_Gorilla/Deakin Uni/Data")
write_csv(Royal_Perth_Hospital)
write_csv(Royal_Perth_Hospital,"Royal_Perth_Hospital" )
t <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/Royal_Perth_Hospital")
View(t)
library(RcppRoll)
weather_lga <- weather_lga %>%
filter(hour == 7) %>%
mutate(t_3d_before = roll_meanr(lag(temp), 3)) %>%
mutate(tdiff_3 = temp - t_3d_before)
weather_lga %>%
ggplot() +
geom_line(aes(dt, tdiff_3))
View(weather_lga)
View(data)
weather_lga <- weather %>%
mutate(dt =  make_date(year, month, day)) %>%
filter(origin == "LGA")
View(weather_lga)
View(data)
data <- data %>% mutate(TAVG = roll_meanr(lag(TMAX), TMIN))
data <- data %>% mutate(TAVG = mean(lag(TMAX),TMIN))
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(date = date(as_date(date)))
data <- data %>% mutate(DATE = date(as_date(DATE)))
View(data)
summarise(t_avg = mean(c(lag(TMIN),TMAX))
data %>%
data %>%
group_by(DATE) %>%
summarise(t_avg = mean(c(lag(TMIN),TMAX)))
data %>%
group_by(DATE) %>%
summarise(t_avg = mean(lag(TMIN),TMAX))
# Because of the ncdc is limited to 1000 rows, 1 year, etc. I downloaded the dataset this way because it's just easier plus I already showed I can use the api...
library(RcppRoll)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data %>% mutate(TAVG = mean(lag(TMAX))
View(data)
View(data)
data <- data %>% mutate(TAVG = mean(lag(TMAX))
View(data)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- data %>% mutate(TAVG = roll_meanr(lag(TMAX))
View(data)
View(data)
data %>% mutate(TAVG = roll_meanr(lag(TMAX))
data <- data %>% mutate(TAVG = roll_meanr(lag(TMAX)))
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- data %>% mutate(TAVG = roll_meanr(lag(TMAX)))
View(data)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- data %>% mutate(TAVG = roll_meanr(lag(TMAX)+TMIN))
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- data %>% mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2))
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- data %>% mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2)
35.4+16.9/2
(35.4+16.9)/2
data <- data %>% mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2) %>% mutate(TDP = roll_meanr(TAVG))
View(data)
data <- data %>% mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2) %>% mutate(TDP = roll_meanr(TAVG,3))
View(data)
data <- data %>%
mutate(TDP = roll_meanr(TAVG,3)) %>%
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2) %>%
mutate(TDP = roll_meanr(TAVG,3)) %>%
muate(EHI_sig = TDP - quantile(TDP,0.95)
View(data)
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2) %>%
mutate(TDP = roll_meanr(TAVG,3)) %>%
muate(EHI_sig = TDP - quantile(TDP,0.95))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2) %>%
mutate(TDP = roll_meanr(TAVG,3)) %>%
mutate(EHI_sig = TDP - quantile(TDP,0.95))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2) %>%
mutate(TDP = roll_meanr(TAVG,3)) %>%
mutate(EHI_sig = TDP - quantile(TDP,0.95, na.rm = TRUE))
View(data)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(RPH_WD, ndate = as.numeric(Date),
nyear  = as.numeric(format(Date, '%Y')),
nmonth = as.numeric(format(Date, '%m')),
doy    = as.numeric(format(Date, '%j')))
View(data)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
View(data)
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2) %>%
mutate(TDP = roll_meanr(TAVG,3)) %>%
mutate(EHI_sig = TDP - quantile(TDP,0.95, na.rm = TRUE))
View(data)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2) %>%
mutate(TDP = roll_meanr(TAVG,3)) %>%
group_by(nyear)
# Because of the ncdc is limited to 1000 rows, 1 year, etc. I downloaded the dataset this way because it's just easier plus I already showed I can use the api...
library(RcppRoll)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2) %>%
mutate(TDP = roll_meanr(TAVG,3)) %>%
group_by(nyear) %>%
mutate(EHI_sig = TDP - quantile(TDP,0.95, na.rm = TRUE))
View(data)
# Because of the ncdc is limited to 1000 rows, 1 year, etc. I downloaded the dataset this way because it's just easier plus I already showed I can use the api...
library(RcppRoll)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2) %>%
mutate(TDP = roll_meanr(TAVG,3)) %>%
test <- data %>% group_by(nyear) %>% mutate(EHI_sig = TDP - quantile(TDP,0.95, na.rm = TRUE))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2) %>%
mutate(TDP = roll_meanr(TAVG,3)) %>%
test <- data %>% group_by(nyear) %>% mutate(EHI_sig = TDP - quantile(TDP,0.95, na.rm = TRUE))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2) %>%
mutate(TDP = roll_meanr(TAVG,3))
test <- data %>% group_by(nyear) %>% mutate(EHI_sig = TDP - quantile(TDP,0.95, na.rm = TRUE))
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX)+TMIN)/2) %>%
mutate(TDP = roll_meanr(TAVG,3))
test <- data %>% group_by(nyear) %>% mutate(EHI_sig = quantile(TDP,0.95, na.rm = TRUE))
View(test)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX) + TMIN) / 2) %>%
mutate(TDP = roll_meanr(TAVG, 3)) %>%
group_by(nyear) %>%
mutate(EHI_sig = TDP - quantile(TDP, 0.95, na.rm = TRUE)) %>%
mutate(EHI_accl = TDP - (roll_meanr(TAVG, 30)))
View(data)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX) + TMIN) / 2) %>%
mutate(TDP = roll_meanr(TAVG, 3)) %>%
group_by(nyear) %>%
mutate(EHI_sig = TDP - quantile(TDP, 0.95, na.rm = TRUE)) %>%
mutate(EHI_accl = TDP - (roll_meanr(TAVG, 30, na.rm = TRUE)))
View(data)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX) + TMIN) / 2) %>%
mutate(TDP = roll_meanr(TAVG, 3)) %>%
group_by(nyear) %>%
mutate(EHI_sig = TDP - quantile(TDP, 0.95, na.rm = TRUE))
data <- data %>%
mutate(EHI_accl = TDP - (roll_meanr(TAVG, 30, na.rm = TRUE)))
View(data)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(EHI_accl = TDP - roll_meanr(TAVG, 30, fill = TRUE))
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX) + TMIN) / 2) %>%
mutate(TDP = roll_meanr(TAVG, 3)) %>%
group_by(nyear) %>%
mutate(EHI_sig = TDP - quantile(TDP, 0.95, na.rm = TRUE))
data <- data %>%
mutate(EHI_accl = TDP - roll_meanr(TAVG, 30))
View(data)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX) + TMIN) / 2) %>%
mutate(TDP = roll_meanr(TAVG, 3)) %>%
group_by(nyear) %>%
mutate(EHI_sig = TDP - quantile(TDP, 0.95, na.rm = TRUE)) %>%
mutate(EHI_accl = TDP - roll_meanr(TAVG, 30))
View(data)
EHF <- data$EHI_sig * data$EHI_accl
EHF
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX) + TMIN) / 2) %>%
mutate(TDP = roll_meanr(TAVG, 3)) %>%
group_by(nyear) %>%
mutate(EHI_sig = TDP - quantile(TDP, 0.95, na.rm = TRUE)) %>%
mutate(EHI_accl = TDP - roll_meanr(TAVG, 30)) %>%
mutate(EHI_sig= if_else(EHI_sig< 0, 0, EHI_sig))
View(data)
View(data)
View(data)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX) + TMIN) / 2) %>%
mutate(TDP = roll_meanr(TAVG, 3)) %>%
group_by(nyear) %>%
mutate(EHI_sig = TDP - quantile(TDP, 0.95, na.rm = TRUE)) %>%
mutate(EHI_accl = TDP - roll_meanr(TAVG, 30)) %>%
mutate(EHI_sig= if_else(EHI_sig< 0, 0, EHI_sig)) %>%
mutate(EHI_accl= if_else(EHI_accl< 1, 1, EHI_accl))
View(data)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
# Because of the ncdc is limited to 1000 rows, 1 year, etc. I downloaded the dataset this way because it's just easier plus I already showed I can use the api...
library(RcppRoll)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX) + TMIN) / 2) %>%
mutate(TDP = roll_meanr(TAVG, 3)) %>%
group_by(nyear) %>%
mutate(EHI_sig = TDP - quantile(TDP, 0.95, na.rm = TRUE)) %>%
mutate(EHI_accl = TDP - roll_meanr(TAVG, 30)) %>%
mutate(EHI_sig= if_else(EHI_sig< 0, 0, EHI_sig)) %>%
mutate(EHI_accl= replace_na(if_else(EHI_accl< 1, 1, EHI_accl), 1))
View(data)
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- read.csv("https://raw.githubusercontent.com/amaye15/Data/main/PERTH_AIRPORT.csv")
data <- data %>% mutate(DATE = date(as_date(DATE)))
data <- transform(data,
nyear  = as.numeric(format(DATE, '%Y')),
nmonth = as.numeric(format(DATE, '%m')),
doy    = as.numeric(format(DATE, '%j')))
data <- data %>%
mutate(TAVG = roll_meanr(lag(TMAX) + TMIN) / 2) %>%
mutate(TDP = roll_meanr(TAVG, 3)) %>%
group_by(nyear) %>%
mutate(EHI_sig = TDP - quantile(TDP, 0.95, na.rm = TRUE)) %>%
mutate(EHI_accl = TDP - roll_meanr(TAVG, 30)) %>%
mutate(EHI_sig= replace_na(if_else(EHI_sig< 0, 0, EHI_sig), 0)) %>%
mutate(EHI_accl= replace_na(if_else(EHI_accl< 1, 1, EHI_accl), 1)) %>%
mutate(EHF = EHI_sig*EHI_accl)
View(data)
View(perth_wd)
